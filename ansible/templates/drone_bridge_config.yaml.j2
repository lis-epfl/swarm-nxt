{% set current_drone_idx = groups['drones'].index(inventory_hostname) %}
name: domain_bridge
from_domain: {{ drone_num }}
to_domain: 0 
topics: 
  /fmu/out/vehicle_status_v1: 
    type: mavros_msgs/msg/State
    remap: {{ns}}/fmu/out/vehicle_status_v1
  /fmu/out/vehicle_local_position: 
    type: px4_msgs/msg/VehicleLocalPosition
    remap: {{ns}}/fmu/out/vehicle_local_position
  {{ns}}/manager/state:
    type: swarmnxt_msgs/msg/DroneState
  agent_{{ current_drone_idx }}/traj_full: 
    type: multi_agent_planner_msgs/msg/Trajectory
  agent_{{ current_drone_idx }}/traj:
    type: nav_msgs/msg/Path
{% for drone in groups['drones'] %}
{% set drone_num_id = drone | regex_replace('\.local', '') | regex_search('[0-9]+$') %}
{% set drone_idx = loop.index0 %}
{% if drone_idx != current_drone_idx %}
  agent_{{ current_drone_idx }}/traj_full:
    type: multi_agent_planner_msgs/msg/Trajectory
    to_domain: {{ drone_num_id }}
{% endif %}
{% endfor %}
